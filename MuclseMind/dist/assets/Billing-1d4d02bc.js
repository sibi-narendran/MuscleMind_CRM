import{r as c,j as e,S as M,G as Q,a5 as le,m as g,a6 as de,i as me,a7 as pe,a8 as ue,a9 as he,g as xe}from"./index-1369e829.js";import{E as ge}from"./jspdf.es.min-4c303147.js";import fe from"./html2canvas.esm-e0a7d97b.js";import{M as G,B as V,I as L}from"./index-ac99bac4.js";import{C as Z}from"./index-33240ace.js";import{D as ye}from"./dollar-sign-8112f778.js";import{S as ve}from"./index-7b979b7f.js";import{c as A}from"./createLucideIcon-c2fbbefa.js";import"./useBubbleLock-b3567789.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=A("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=A("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=A("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=A("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),J=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),_e=async(r,m)=>{let o=null;try{if(!m||!m.data)throw new Error("User profile data is missing");const u=m.data.header_image_url,p=m.data.gst_number;console.log("Header Image URL:",u),o=document.createElement("div"),o.style.position="absolute",o.style.left="-9999px",o.style.top="-9999px",o.style.width="210mm",o.style.height="297mm",document.body.appendChild(o);const b=J(r.date),h=r.treatment_name.split(",").map((N,T)=>({name:N.trim(),cost:(r.cost/r.treatment_name.split(",").length).toFixed(2),date:b}));o.innerHTML=`
      <!-- Header -->
      <div class="w-full h-[60mm]">
        <img 
          src="${u}" 
          style="width: 100%; height: 100%; object-fit: contain; max-width: 100%; image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;" 
        />
      </div>
     <div class="w-full h-full relative bg-white" style="color: #000000;">
       <!-- Content -->
       <div class="px-10 py-6">
         <!-- Invoice Info -->
         <div style="margin-bottom: 2rem;">
           <div style="display: flex; justify-content: space-between; margin-bottom: 2rem;">
           
             <!-- Patient Info - Left Side -->
             <div>
               <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: #000000;">Patient Information</h3>
               <p style="margin-bottom: 0.5rem; color: #000000;"><span style="font-weight: 600;">Name:</span> ${r.patient_name}</p>
             </div>
 
             <!-- Invoice Details - Right Side -->
             <div style="text-align: right;">
               <h2 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem; color: #000000;">INVOICE</h2>
                <p style="margin-bottom: 0.5rem; color: #000000;"><span style="font-weight: 600;">GST No:</span> ${p}</p>
               <p style="margin-bottom: 0.5rem; color: #000000;"><span style="font-weight: 600;">Invoice No:</span> #${r.invoice_no}</p>
               <p style="margin-bottom: 0.5rem; color: #000000;"><span style="font-weight: 600;">Date:</span> ${J(r.date)}</p>
             </div>
           </div>
         </div>
 
         <!-- Treatment Details -->
         <div style="margin-bottom: 2rem;">
           <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: #000000;">Treatment Details</h3>
           <table style="width: 100%; border-collapse: collapse; color: #000000;">
             <thead>
               <tr style="background-color: #f8f9fa;">
                 <th style="padding: 0.75rem 1rem; text-align: left; font-weight: 600; border-bottom: 1px solid #000000;">S.No.</th>
                 <th style="padding: 0.75rem 1rem; text-align: center; font-weight: 600; border-bottom: 1px solid #000000;">Treatment</th>
                 <th style="padding: 0.75rem 1rem; text-align: right; font-weight: 600; border-bottom: 1px solid #000000;">Amount</th>
               </tr>
             </thead>
             <tbody>
               ${h.map((N,T)=>`
                 <tr>
                   <td style="padding: 0.75rem 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">${T+1}</td>
                   <td style="padding: 0.75rem 1rem;  text-align: center; border-bottom: 1px solid #e5e7eb;">${N.name}</td>
                   <td style="padding: 0.75rem 1rem; text-align: right; border-bottom: 1px solid #e5e7eb;">₹${N.cost}</td>
                 </tr>
               `).join("")}
             </tbody>
           </table>
         </div>
 
         <!-- Total Amount -->
         <div style="margin-top: 2rem; text-align: right; border-top: 1px solid #000000; padding-top: 1rem;">
           <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem; color: #000000;">Total Amount</h3>
           <p style="font-size: 1.5rem; font-weight: bold; color: #000000;">₹${typeof r.cost=="string"?parseFloat(r.cost).toFixed(2):r.cost.toFixed(2)}</p>
         </div>
       </div>
     </div>
   `;const D=await fe(o,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:795,height:1123}),y=new ge({orientation:"portrait",unit:"mm",format:"a4"}),w=D.toDataURL("image/jpeg",1);y.addImage(w,"JPEG",0,0,210,297);const P=`invoice-${r.invoice_no}.pdf`;return y.save(P),!0}catch(u){return console.error("Error generating PDF:",u),!1}finally{o&&document.body.contains(o)&&document.body.removeChild(o)}},{Option:W}=M,Ce=({isOpen:r,onClose:m,billing:o,onUpdate:u})=>{const[p,b]=c.useState(o),[h,D]=c.useState([]),[y,w]=c.useState({}),[P,N]=c.useState((o==null?void 0:o.cost)||0),[T,I]=c.useState({});c.useEffect(()=>{(async()=>{try{const l=await Q();D(l.data||[])}catch(l){console.error("Error fetching treatments:",l)}})()},[]),c.useEffect(()=>{if(o&&h.length>0&&(b(o),N(o.cost),o.treatment_name)){const i=o.treatment_name.split(", "),l={},x={};i.forEach(v=>{const C=h.find(s=>s.procedure_name===v);C&&(l[C.treatment_id]=!0,x[C.treatment_id]=parseFloat(C.cost)||0)}),w(l),I(x)}},[o,h]);const B=(i,l)=>{const x=h.find(v=>v.treatment_id===i);x&&(w(v=>({...v,[i]:l})),I(v=>{const C={...v};return l?C[i]=parseFloat(x.cost)||0:delete C[i],C}))},F=(i,l)=>{I(x=>({...x,[i]:parseFloat(l)||0}))};c.useEffect(()=>{const i=Object.values(T).reduce((l,x)=>l+(parseFloat(x)||0),0);N(i)},[T]);const O=async()=>{try{if(!p.id)throw new Error("Billing ID is missing");const i={...p,cost:P,treatment_name:Object.keys(y).filter(l=>y[l]).map(l=>{var x;return(x=h.find(v=>v.treatment_id===parseInt(l)))==null?void 0:x.procedure_name}).filter(Boolean).join(", ")};await le(p.id,i),g.success("Billing updated successfully"),u(),m()}catch(i){console.error("Update error:",i),g.error("Failed to update billing: "+i.message)}};return e.jsx(G,{title:"Edit Billing",open:r,onCancel:m,footer:[e.jsx(V,{onClick:m,children:"Cancel"},"cancel"),e.jsx(V,{type:"primary",onClick:O,children:"Update"},"submit")],children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Invoice Number"}),e.jsx(L,{value:p==null?void 0:p.invoice_no,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Patient Name"}),e.jsx(L,{value:p==null?void 0:p.patient_name,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Status"}),e.jsxs(M,{value:p==null?void 0:p.invoice_status,onChange:i=>b(l=>({...l,invoice_status:i})),className:"w-full",children:[e.jsx(W,{value:"Paid",children:"Paid"}),e.jsx(W,{value:"Pending",children:"Pending"}),e.jsx(W,{value:"Not Paid",children:"Not Paid"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Treatments"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:h.map(i=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Z,{checked:y[i.treatment_id],onChange:l=>B(i.treatment_id,l.target.checked)}),e.jsx("span",{className:"flex-grow",children:i.procedure_name}),y[i.treatment_id]&&e.jsx(L,{type:"number",className:"w-24",value:T[i.treatment_id],onChange:l=>F(i.treatment_id,l.target.value)})]},i.treatment_id))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Total Cost"}),e.jsx(L,{value:P.toFixed(2),disabled:!0,prefix:"$"})]})]})})};var ee={exports:{}},Se="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Te=Se,Pe=Te;function te(){}function ae(){}ae.resetWarningCache=te;var De=function(){function r(u,p,b,h,D,y){if(y!==Pe){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}r.isRequired=r;function m(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:m,element:r,elementType:r,instanceOf:m,node:r,objectOf:m,oneOf:m,oneOfType:m,shape:m,exact:m,checkPropTypes:ae,resetWarningCache:te};return o.PropTypes=o,o};ee.exports=De();var Fe=ee.exports;const Y=de(Fe),{Option:H}=M,se=({isOpen:r,onClose:m,onSuccess:o})=>{const[u,p]=c.useState({patient_id:"",patient_name:"",treatment_name:"",treatment_id:"",invoice_status:"Pending",date:new Date().toISOString().split("T")[0]}),[b,h]=c.useState([]),[D,y]=c.useState([]),[w,P]=c.useState({}),[N,T]=c.useState({}),[I,B]=c.useState(0),[F,O]=c.useState(!1);c.useEffect(()=>{r&&(async()=>{try{const[d,k]=await Promise.all([Q(),me()]);h(d.data||[]),y(k.data||[])}catch(d){console.error("Error fetching data:",d),g.error("Failed to load data")}})()},[r]);const i=(s,d)=>{p(k=>({...k,patient_id:s,patient_name:d.children}))},l=(s,d)=>{const k=b.find(j=>j.treatment_id===s);k&&(P(j=>({...j,[s]:d})),T(j=>{const E={...j};return d?E[s]=parseFloat(k.cost)||0:delete E[s],E}))},x=(s,d)=>{T(k=>({...k,[s]:parseFloat(d)||0}))};c.useEffect(()=>{const s=Object.values(N).reduce((d,k)=>d+(parseFloat(k)||0),0);B(s)},[N]);const v=()=>{p({patient_id:"",patient_name:"",treatment_name:"",treatment_id:"",invoice_status:"Pending",date:new Date().toISOString().split("T")[0]}),P({}),T({}),B(0)},C=async()=>{try{if(F)return;if(O(!0),!u.patient_id){g.error("Please select a patient");return}if(Object.keys(w).length===0){g.error("Please select at least one treatment");return}const s=Object.keys(w).filter(j=>w[j]).map(j=>{const E=b.find(S=>S.treatment_id===parseInt(j));return{treatment_id:E.treatment_id,treatment_name:E.procedure_name,cost:N[j]}}),d={invoice_no:`INV-${Date.now().toString().slice(-6)}`,patient_id:u.patient_id,patient_name:u.patient_name,treatment_id:s.map(j=>j.treatment_id).join(","),treatment_name:s.map(j=>j.treatment_name).join(", "),cost:I,invoice_status:u.invoice_status,date:u.date},k=await pe(d);if(k.success)await o(),v();else throw new Error(k.message||"Failed to create invoice")}catch(s){s.message.includes("already exists")?g.error("This invoice number already exists. Please try again."):g.error("Failed to create invoice: "+s.message)}finally{O(!1)}};return e.jsx(G,{title:"Create New Invoice",open:r,onCancel:m,footer:[e.jsx(V,{onClick:m,children:"Cancel"},"cancel"),e.jsx(V,{type:"primary",onClick:C,loading:F,disabled:F,children:"Create Invoice"},"submit")],children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Patient Name"}),e.jsx(M,{showSearch:!0,value:u.patient_id,onChange:i,placeholder:"Select a patient",className:"w-full",filterOption:(s,d)=>d.children.toLowerCase().indexOf(s.toLowerCase())>=0,children:D.map(s=>e.jsx(H,{value:s.id,children:`${s.patient_id}-${s.name}`},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Status"}),e.jsxs(M,{value:u.invoice_status,onChange:s=>p(d=>({...d,invoice_status:s})),className:"w-full",children:[e.jsx(H,{value:"Paid",children:"Paid"}),e.jsx(H,{value:"Pending",children:"Pending"}),e.jsx(H,{value:"Not Paid",children:"Not Paid"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Treatments"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:b.map(s=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Z,{checked:w[s.treatment_id],onChange:d=>l(s.treatment_id,d.target.checked)}),e.jsx("span",{className:"flex-grow",children:s.procedure_name}),w[s.treatment_id]&&e.jsx(L,{type:"number",className:"w-24",value:N[s.treatment_id],onChange:d=>x(s.treatment_id,d.target.value)})]},s.treatment_id))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Total Cost"}),e.jsx(L,{value:I.toFixed(2),disabled:!0,prefix:"$"})]})]})})};se.propTypes={isOpen:Y.bool.isRequired,onClose:Y.func.isRequired,onSuccess:Y.func.isRequired};const K="/assets/invoice-9d3d15de.png",ze=()=>{const[r,m]=c.useState([]),[o,u]=c.useState(!0),[p,b]=c.useState(null),[h,D]=c.useState(""),[y,w]=c.useState("all");c.useState([]);const[P,N]=c.useState({}),[T,I]=c.useState(0),[B,F]=c.useState(!1),[O,i]=c.useState("desc"),[l,x]=c.useState(!1);c.useEffect(()=>{v()},[]);const v=async()=>{var t;try{u(!0);const a=await ue();m(((t=a.data)==null?void 0:t.filter(_=>_!==null))||[])}catch(a){console.error("Error fetching billings:",a),g.error("Failed to fetch billings"),m([])}finally{u(!1)}},C=async()=>{try{await v(),F(!1),b(null)}catch(t){console.error("Error updating billing:",t),g.error("Failed to update billing")}},s=async t=>{G.confirm({title:"Are you sure you want to delete this invoice?",content:"This action cannot be undone.",okText:"Yes, Delete",okType:"danger",cancelText:"No, Cancel",onOk:async()=>{try{await he(t),g.success("Invoice deleted successfully"),v()}catch(a){g.error("Failed to delete invoice"),console.error("Failed to delete billing:",a)}}})},d=t=>{switch(t){case"Paid":return"text-meta-3 bg-meta-4 dark:bg-meta-4 dark:meta-3";case"Pending":return"text-meta-6 bg-meta-4 dark:bg-meta-4 dark:text-meta-6";case"Not Paid":return"text-meta-1 bg-meta-4 dark:bg-meta-4 dark:text-meta-1";default:return"text-gray-700 bg-gray-100 dark:bg-meta-2 dark:text-gray-100"}};c.useEffect(()=>{const t=Object.values(P).reduce((a,_)=>a+parseFloat(_),0);I(t)},[P]);const k=async t=>{if(!t){g.error("Invalid billing data");return}if(t.invoice_status!=="Paid"){G.warning({title:"Payment Pending",content:e.jsxs("div",{children:[e.jsxs("p",{children:["This invoice cannot be downloaded as payment is ",t.invoice_status.toLowerCase(),"."]}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Please complete the payment to generate the invoice."})]}),okText:"Close",centered:!0,className:"custom-modal-warning"});return}try{const a=await xe();if(console.log("User Profile Response:",a),!a||!a.data)throw new Error("Failed to fetch user profile");await _e(t,a)?g.success("Invoice PDF generated successfully"):g.error("Failed to generate PDF")}catch(a){console.error("Error generating PDF:",a),g.error("Failed to generate PDF: "+a.message)}},j=t=>{const a=t.invoice_status==="Paid";return e.jsx("button",{onClick:()=>k(t),className:`p-2 rounded-lg ${a?"text-success hover:bg-success/10 active:bg-success/20":"text-gray-400 cursor-not-allowed"}`,disabled:!a,title:a?"Download Invoice":"Payment pending",children:e.jsx(je,{size:18})})},E=t=>{if(!t.id){g.error("Invalid billing record");return}b(t),F(!0)},S=r.filter(t=>{var _,$,U,z,R,q;if(!t)return!1;const a=h.toLowerCase().trim();if(h==="")return!0;switch(y){case"invoice":return(_=t.invoice_no)==null?void 0:_.toLowerCase().includes(a);case"patient":return($=t.patient_id)==null?void 0:$.toLowerCase().includes(a);case"name":return(U=t.patient_name)==null?void 0:U.toLowerCase().includes(a);case"all":default:return((z=t.invoice_no)==null?void 0:z.toLowerCase().includes(a))||((R=t.patient_id)==null?void 0:R.toLowerCase().includes(a))||((q=t.patient_name)==null?void 0:q.toLowerCase().includes(a))}}),re=t=>{if(!t)return"N/A";try{return new Date(t).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"})}catch(a){return console.error("Error formatting date:",a),"Invalid Date"}},X=[...S].sort((t,a)=>{if(!(t!=null&&t.date)||!(a!=null&&a.date))return 0;const _=new Date(t.date),$=new Date(a.date);return O==="desc"?$-_:_-$}),ne=["Invoice Number","Patient Name","Treatment Name",{label:"Date",sortable:!0,onClick:()=>{i(t=>t==="desc"?"asc":"desc")},icon:O==="desc"?"↓":"↑"},"Total Amount","Status","Actions"],oe=()=>{const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1),_=S.filter(n=>(n==null?void 0:n.invoice_status)==="Paid").reduce((n,f)=>n+(parseFloat(f==null?void 0:f.cost)||0),0),$=S.filter(n=>(n==null?void 0:n.invoice_status)!=="Paid").reduce((n,f)=>n+(parseFloat(f==null?void 0:f.cost)||0),0),U=S.filter(n=>{const f=new Date(n==null?void 0:n.date);return(n==null?void 0:n.invoice_status)==="Paid"&&f>=a&&f<=t}).reduce((n,f)=>n+(parseFloat(f==null?void 0:f.cost)||0),0),z=S.filter(n=>(n==null?void 0:n.invoice_status)!=="Paid").length,R=S.filter(n=>{const f=new Date(n==null?void 0:n.date);return(n==null?void 0:n.invoice_status)==="Paid"&&f>=a&&f<=t}).length,q=S.length>0?(_/S.filter(n=>(n==null?void 0:n.invoice_status)==="Paid").length).toFixed(2):0;return[{title:"Total Revenue",value:`$${_.toFixed(2)}`,trend:`${R} invoices paid`,trendColor:"text-green-600"},{title:"Outstanding",value:`$${$.toFixed(2)}`,trend:`${z} pending invoices`,trendColor:"text-red-600"},{title:"Paid This Month",value:`$${U.toFixed(2)}`,trend:`${R} payments received`,trendColor:"text-green-600"},{title:"Average Invoice",value:`$${q}`,trend:"Based on paid invoices",trendColor:"text-blue-600"}]},ie=()=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(we,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:h,onChange:t=>D(t.target.value),className:`block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg \r
                     focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary\r
                     dark:bg-boxdark dark:border-strokedark dark:text-white`,placeholder:"Search invoices..."}),h&&e.jsx("button",{onClick:()=>D(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(Ne,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:y,onChange:t=>w(t.target.value),className:`px-3 py-2 border border-gray-200 rounded-lg focus:outline-none \r
                     focus:border-primary dark:bg-boxdark dark:border-strokedark dark:text-white`,children:[e.jsx("option",{value:"all",children:"All Fields"}),e.jsx("option",{value:"invoice",children:"Invoice Number"}),e.jsx("option",{value:"patient",children:"Patient ID"}),e.jsx("option",{value:"name",children:"Patient Name"})]})})]}),h&&e.jsxs("div",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:["Found ",S.length," result",S.length!==1?"s":"",y!=="all"&&` for ${y}`]})]}),ce=async()=>{try{await v(),g.success("Invoice created successfully"),x(!1)}catch(t){console.error("Error refreshing billings:",t),g.error("Invoice created but failed to refresh list")}};return e.jsxs("div",{className:"p-6 dark:bg-boxdark",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 md:mb-0",children:"Billing & Invoices"}),e.jsx("div",{className:"flex space-x-4",children:e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ye,{className:"h-5 w-5 mr-2"}),"New Invoice"]})})]}),ie(),e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:oe().map((t,a)=>e.jsxs("div",{className:"bg-white dark:bg-boxdark p-6 rounded-xl shadow-sm border border-gray-100 dark:border-strokedark",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t.title}),e.jsx("p",{className:"text-2xl font-semibold mt-2 text-gray-900 dark:text-white",children:t.value}),e.jsx("p",{className:`text-sm mt-2 ${t.trendColor}`,children:t.trend})]},a))}),e.jsxs("div",{className:"bg-white dark:bg-boxdark rounded-xl shadow-sm border border-gray-100 dark:border-strokedark",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-strokedark",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Billings"})}),o?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("img",{src:K,alt:"Loading",className:"w-32 h-32 mb-4 opacity-50"}),e.jsx(ve,{size:"large"}),e.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-400",children:"Loading invoices..."})]}):X.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("img",{src:K,alt:"No Invoices",className:"w-32 h-32 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"No Invoices Found"}),e.jsx("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:h?"No invoices match your search":"Create your first invoice by clicking the 'New Invoice' button above"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gray-50 dark:bg-strokedark",children:ne.map((t,a)=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-meta-2 uppercase tracking-wider",onClick:typeof t=="object"&&t.sortable?t.onClick:void 0,style:typeof t=="object"&&t.sortable?{cursor:"pointer"}:{},children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:typeof t=="object"?t.label:t}),typeof t=="object"&&t.sortable&&e.jsx("span",{className:"text-xs",children:t.icon})]})},a))})}),e.jsx("tbody",{className:"bg-white dark:bg-boxdark divide-y divide-gray-200 dark:divide-strokedark",children:X.map(t=>t&&e.jsxs("tr",{className:"border-b dark:border-strokedark",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:["#",t.invoice_no||"N/A"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.patient_name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-meta-2",children:t.treatment_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-meta-2",children:re(t.date)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:["$",parseFloat(t.cost||0).toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${d(t.invoice_status)}`,children:t.invoice_status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[j(t),e.jsx("button",{onClick:()=>E(t),className:"p-2 rounded-lg text-primary hover:bg-primary/10 active:bg-primary/20",children:e.jsx(ke,{size:18})}),e.jsx("button",{onClick:()=>s(t.id),className:"p-2 rounded-lg text-danger hover:bg-danger/10 active:bg-danger/20",children:e.jsx(be,{size:18})})]})})]},t.id))})]})})]}),e.jsx(se,{isOpen:l,onClose:()=>x(!1),onSuccess:ce}),e.jsx(Ce,{isOpen:B,onClose:()=>{F(!1),b(null)},billing:p,onUpdate:C})]})};export{ze as default};
